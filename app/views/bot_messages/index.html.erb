<!-- チャットボット -->
<div id="chat-bot-container">
  <!-- メッセージ表示部分 -->
  <div id="messages">
    <% if @messages %>
      <% @messages.each do |message| %>
        <div class="message <%= message['role'] == 'user' ? 'user' : '' %>">
          <p><%= message['content'] %></p>
        </div>
      <% end %>
    <% end %>
  </div>

  <!-- 入力部分 -->
  <div id="message-form">
    <%= form_with(url: bot_messages_path, local: true, id: 'chat-message-form') do |form| %>
      <%= form.text_field :message, id: 'message_input', placeholder: 'メッセージを入力' %>
      <%= form.submit '送信' %>
      <%= form.submit '削除', formaction: bot_messages_clear_session_path %>
    <% end %>
  </div>
</div>

<!-- ページ内のスクリプト -->
<script>
  // 自動でスクロールする
  document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;

  // セッションの内容をコンソールに出力
  const sessionMessages = <%= @messages ? @messages.to_json.html_safe : 'null' %>;
  console.log('Session Messages:', sessionMessages);
</script>
