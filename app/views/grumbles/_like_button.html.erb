<%= turbo_frame_tag dom_id(grumble, :like_area) do %>
  <% if user_signed_in? %>
    <% liked = current_user.likes.exists?(grumble: grumble) %>

    <%= form_with url: (liked ? unlike_grumble_path(grumble) : like_grumble_path(grumble)),
                  method: (liked ? :delete : :post),
                  local: true do %>
      <button type="submit"
              class="btn btn-sm d-flex align-items-center <%= liked ? "btn-outline-danger" : "btn-outline-primary" %>"
              data-test="like-button"
              aria-label="like-toggle">
        <i class="<%= liked ? "fa-solid" : "fa-regular" %> fa-heart me-1"></i>
        <span data-test="like-count"><%= grumble.likes.count %></span>
      </button>
    <% end %>

  <% else %>
    <!-- 未ログイン時：押せない表示 -->
    <button class="btn btn-sm btn-outline-secondary d-flex align-items-center"
            disabled
            title="いいねするにはログインしてください"
            data-test="like-button-disabled">
      <i class="fa-regular fa-heart me-1"></i>
      <span data-test="like-count"><%= grumble.likes.count %></span>
    </button>
  <% end %>
<% end %>