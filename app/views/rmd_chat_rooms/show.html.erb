<div id="chat-bot-container">
<div id="rmd-chat-messages" class="p-3" style="height: 75vh; overflow-y: auto;">
  <%= render @rmd_chat_messages, viewer_id: current_user.id %>
  <div id="chat-bottom"></div>
</div>

<%= form_with url: "#", local: true, html: { id: "chat-form", class: "bg-white p-2 border-top" } do %>
  <div class="input-group">
    <textarea id="chat-message-textarea"
              class="form-control"
              data-chat-room-id="<%= @rmd_chat_room.id %>"
              rows="1"
              style="resize: none;"
              placeholder="メッセージを入力"></textarea>
    <button type="submit" class="btn btn-dark">送信</button>
  </div>
<% end %>
</div>

<!-- ページ内スクリプト（下までスクロール） -->
<script>
  function scrollToBottom() {
    const bottom = document.getElementById("chat-bottom");
    if (bottom) bottom.scrollIntoView({ behavior: "smooth" });
  }

  document.addEventListener("turbo:load", scrollToBottom);
  document.addEventListener("turbo:submit-end", scrollToBottom);
</script>
